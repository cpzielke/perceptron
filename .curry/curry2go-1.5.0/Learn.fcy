Prog "Learn" ["Algorithms","Network","Perceptron","Prelude"] [] [Func ("Learn","deltaOut") 3 Public (FuncType (TCons ("Network","Layer") []) (FuncType (TCons ("Prelude","[]") [TCons ("Prelude","Float") []]) (FuncType (TCons ("Prelude","[]") [TCons ("Prelude","Float") []]) (TCons ("Prelude","[]") [TCons ("Prelude","Float") []])))) (Rule [1,2,3] (Case Flex (Var 2) [Branch (Pattern ("Prelude","[]") []) (Case Flex (Var 3) [Branch (Pattern ("Prelude","[]") []) (Comb ConsCall ("Prelude","[]") []),Branch (Pattern ("Prelude",":") [4,5]) (Comb FuncCall ("Prelude","failed") [])]),Branch (Pattern ("Prelude",":") [6,7]) (Case Flex (Var 3) [Branch (Pattern ("Prelude",":") [8,9]) (Let [(10,Comb FuncCall ("Algorithms","activation_der") [Comb FuncCall ("Network","algorithm") [Var 1]])] (Comb ConsCall ("Prelude",":") [Comb FuncCall ("Prelude","_impl#*#Prelude.Num#Prelude.Float#") [Comb FuncCall ("Prelude","_impl#-#Prelude.Num#Prelude.Float#") [Var 8,Var 6],Comb FuncCall ("Prelude","apply") [Var 10,Var 8]],Comb FuncCall ("Learn","deltaOut") [Var 1,Var 7,Var 9]])),Branch (Pattern ("Prelude","[]") []) (Comb FuncCall ("Prelude","failed") [])])])),Func ("Learn","deltaNeuron") 3 Public (FuncType (TCons ("Prelude","Int") []) (FuncType (TCons ("Prelude","[]") [TCons ("Prelude","[]") [TCons ("Prelude","Float") []]]) (FuncType (TCons ("Prelude","[]") [TCons ("Prelude","Float") []]) (TCons ("Prelude","Float") [])))) (Rule [1,2,3] (Let [(4,Comb FuncCall ("Prelude","map") [Comb (FuncPartCall 1) ("Prelude","flip") [Comb (FuncPartCall 2) ("Prelude","!!") [],Var 1],Var 2])] (Comb FuncCall ("Perceptron","dotProduct") [Var 4,Var 3]))),Func ("Learn","deltaInner") 5 Public (FuncType (TCons ("Prelude","Int") []) (FuncType (TCons ("Network","Layer") []) (FuncType (TCons ("Prelude","[]") [TCons ("Prelude","[]") [TCons ("Prelude","Float") []]]) (FuncType (TCons ("Prelude","[]") [TCons ("Prelude","Float") []]) (FuncType (TCons ("Prelude","[]") [TCons ("Prelude","Float") []]) (TCons ("Prelude","[]") [TCons ("Prelude","Float") []])))))) (Rule [1,2,3,4,5] (Case Flex (Var 5) [Branch (Pattern ("Prelude","[]") []) (Comb ConsCall ("Prelude","[]") []),Branch (Pattern ("Prelude",":") [6,7]) (Let [(8,Comb FuncCall ("Algorithms","activation_der") [Comb FuncCall ("Network","algorithm") [Var 2]]),(9,Comb FuncCall ("Prelude","_impl#*#Prelude.Num#Prelude.Float#") [Comb FuncCall ("Learn","deltaNeuron") [Var 1,Var 3,Var 4],Comb FuncCall ("Prelude","apply") [Var 8,Var 6]])] (Comb ConsCall ("Prelude",":") [Var 9,Comb FuncCall ("Learn","deltaInner") [Comb FuncCall ("Prelude","_impl#+#Prelude.Num#Prelude.Int#") [Var 1,Lit (Intc 1)],Var 2,Var 3,Var 4,Var 7]]))])),Func ("Learn","backPropagate") 4 Public (FuncType (TCons ("Prelude","[]") [TCons ("Network","Layer") []]) (FuncType (TCons ("Prelude","[]") [TCons ("Prelude","Float") []]) (FuncType (TCons ("Prelude","[]") [TCons ("Prelude","[]") [TCons ("Prelude","[]") [TCons ("Prelude","Float") []]]]) (FuncType (TCons ("Prelude","[]") [TCons ("Prelude","[]") [TCons ("Prelude","Float") []]]) (TCons ("Prelude","[]") [TCons ("Prelude","[]") [TCons ("Prelude","Float") []]]))))) (Rule [1,2,3,4] (Case Flex (Var 1) [Branch (Pattern ("Prelude",":") [5,6]) (Case Flex (Var 4) [Branch (Pattern ("Prelude",":") [7,8]) (Comb FuncCall ("Learn","backPropagate.backProp.24") [Var 6,Var 3,Comb FuncCall ("Learn","deltaOut") [Var 5,Var 2,Var 7],Var 8]),Branch (Pattern ("Prelude","[]") []) (Comb FuncCall ("Prelude","failed") [])]),Branch (Pattern ("Prelude","[]") []) (Comb FuncCall ("Prelude","failed") [])])),Func ("Learn","backPropagate.backProp.24") 4 Private (FuncType (TCons ("Prelude","[]") [TCons ("Network","Layer") []]) (FuncType (TCons ("Prelude","[]") [TCons ("Prelude","[]") [TCons ("Prelude","[]") [TCons ("Prelude","Float") []]]]) (FuncType (TCons ("Prelude","[]") [TCons ("Prelude","Float") []]) (FuncType (TCons ("Prelude","[]") [TCons ("Prelude","[]") [TCons ("Prelude","Float") []]]) (TCons ("Prelude","[]") [TCons ("Prelude","[]") [TCons ("Prelude","Float") []]]))))) (Rule [1,2,3,4] (Case Flex (Var 1) [Branch (Pattern ("Prelude","[]") []) (Comb ConsCall ("Prelude",":") [Var 3,Comb ConsCall ("Prelude","[]") []]),Branch (Pattern ("Prelude",":") [5,6]) (Case Flex (Var 2) [Branch (Pattern ("Prelude",":") [7,8]) (Case Flex (Var 4) [Branch (Pattern ("Prelude",":") [9,10]) (Let [(11,Comb FuncCall ("Learn","deltaInner") [Lit (Intc 0),Var 5,Var 7,Var 3,Var 9])] (Comb ConsCall ("Prelude",":") [Var 3,Comb FuncCall ("Learn","backPropagate.backProp.24") [Var 6,Var 8,Var 11,Var 10]])),Branch (Pattern ("Prelude","[]") []) (Comb FuncCall ("Prelude","failed") [])]),Branch (Pattern ("Prelude","[]") []) (Comb FuncCall ("Prelude","failed") [])])])),Func ("Learn","adjustNeuron") 4 Private (FuncType (TCons ("Prelude","Float") []) (FuncType (TCons ("Prelude","[]") [TCons ("Prelude","Float") []]) (FuncType (TCons ("Prelude","[]") [TCons ("Prelude","Float") []]) (FuncType (TCons ("Prelude","Float") []) (TCons ("Prelude","[]") [TCons ("Prelude","Float") []]))))) (Rule [1,2,3,4] (Case Flex (Var 2) [Branch (Pattern ("Prelude",":") [5,6]) (Case Flex (Var 3) [Branch (Pattern ("Prelude","[]") []) (Case Flex (Var 6) [Branch (Pattern ("Prelude","[]") []) (Comb ConsCall ("Prelude",":") [Comb FuncCall ("Prelude","_impl#-#Prelude.Num#Prelude.Float#") [Var 5,Comb FuncCall ("Prelude","_impl#*#Prelude.Num#Prelude.Float#") [Var 1,Var 4]],Comb ConsCall ("Prelude","[]") []]),Branch (Pattern ("Prelude",":") [7,8]) (Comb FuncCall ("Prelude","failed") [])]),Branch (Pattern ("Prelude",":") [9,10]) (Comb ConsCall ("Prelude",":") [Comb FuncCall ("Prelude","_impl#-#Prelude.Num#Prelude.Float#") [Var 5,Comb FuncCall ("Prelude","_impl#*#Prelude.Num#Prelude.Float#") [Comb FuncCall ("Prelude","_impl#*#Prelude.Num#Prelude.Float#") [Var 1,Var 4],Var 9]],Comb FuncCall ("Learn","adjustNeuron") [Var 1,Var 6,Var 10,Var 4]])]),Branch (Pattern ("Prelude","[]") []) (Comb FuncCall ("Prelude","failed") [])])),Func ("Learn","adjustLayer") 4 Private (FuncType (TCons ("Prelude","Float") []) (FuncType (TCons ("Prelude","[]") [TCons ("Prelude","[]") [TCons ("Prelude","Float") []]]) (FuncType (TCons ("Prelude","[]") [TCons ("Prelude","Float") []]) (FuncType (TCons ("Prelude","[]") [TCons ("Prelude","Float") []]) (TCons ("Prelude","[]") [TCons ("Prelude","[]") [TCons ("Prelude","Float") []]]))))) (Rule [1,2,3,4] (Case Flex (Var 2) [Branch (Pattern ("Prelude",":") [5,6]) (Case Flex (Var 4) [Branch (Pattern ("Prelude",":") [7,8]) (Let [(9,Comb FuncCall ("Learn","adjustNeuron") [Var 1,Var 5,Var 3,Var 7])] (Case Rigid (Comb FuncCall ("Prelude","_impl#==#Prelude.Eq#[]#0##") [Comb (FuncPartCall 1) ("Prelude","_inst#Prelude.Eq#[]#0##") [Comb (FuncPartCall 1) ("Prelude","_inst#Prelude.Eq#Prelude.Float#") []],Var 6,Comb ConsCall ("Prelude","[]") []]) [Branch (Pattern ("Prelude","True") []) (Comb ConsCall ("Prelude",":") [Var 9,Comb ConsCall ("Prelude","[]") []]),Branch (Pattern ("Prelude","False") []) (Comb ConsCall ("Prelude",":") [Var 9,Comb FuncCall ("Learn","adjustLayer") [Var 1,Var 6,Var 3,Var 8]])])),Branch (Pattern ("Prelude","[]") []) (Comb FuncCall ("Prelude","failed") [])]),Branch (Pattern ("Prelude","[]") []) (Comb FuncCall ("Prelude","failed") [])])),Func ("Learn","gradientDescent") 4 Public (FuncType (TCons ("Prelude","Float") []) (FuncType (TCons ("Prelude","[]") [TCons ("Prelude","[]") [TCons ("Prelude","[]") [TCons ("Prelude","Float") []]]]) (FuncType (TCons ("Prelude","[]") [TCons ("Prelude","[]") [TCons ("Prelude","Float") []]]) (FuncType (TCons ("Prelude","[]") [TCons ("Prelude","[]") [TCons ("Prelude","Float") []]]) (TCons ("Prelude","[]") [TCons ("Prelude","[]") [TCons ("Prelude","[]") [TCons ("Prelude","Float") []]]]))))) (Rule [1,2,3,4] (Case Flex (Var 2) [Branch (Pattern ("Prelude",":") [5,6]) (Case Flex (Var 3) [Branch (Pattern ("Prelude",":") [7,8]) (Case Flex (Var 8) [Branch (Pattern ("Prelude",":") [9,10]) (Case Flex (Var 4) [Branch (Pattern ("Prelude",":") [11,12]) (Let [(13,Comb FuncCall ("Learn","adjustLayer") [Var 1,Var 5,Var 9,Var 11])] (Case Rigid (Comb FuncCall ("Prelude","_impl#==#Prelude.Eq#[]#0##") [Comb (FuncPartCall 1) ("Prelude","_inst#Prelude.Eq#[]#0##") [Comb (FuncPartCall 1) ("Prelude","_inst#Prelude.Eq#[]#0##") [Comb (FuncPartCall 1) ("Prelude","_inst#Prelude.Eq#Prelude.Float#") []]],Var 6,Comb ConsCall ("Prelude","[]") []]) [Branch (Pattern ("Prelude","True") []) (Comb ConsCall ("Prelude",":") [Var 13,Comb ConsCall ("Prelude","[]") []]),Branch (Pattern ("Prelude","False") []) (Comb ConsCall ("Prelude",":") [Var 13,Comb FuncCall ("Learn","gradientDescent") [Var 1,Var 6,Comb ConsCall ("Prelude",":") [Var 9,Var 10],Var 12]])])),Branch (Pattern ("Prelude","[]") []) (Comb FuncCall ("Prelude","failed") [])]),Branch (Pattern ("Prelude","[]") []) (Comb FuncCall ("Prelude","failed") [])]),Branch (Pattern ("Prelude","[]") []) (Comb FuncCall ("Prelude","failed") [])]),Branch (Pattern ("Prelude","[]") []) (Comb FuncCall ("Prelude","failed") [])])),Func ("Learn","learnExample") 3 Public (FuncType (TCons ("Network","Network") []) (FuncType (TCons ("Prelude","[]") [TCons ("Prelude","[]") [TCons ("Prelude","[]") [TCons ("Prelude","Float") []]]]) (FuncType (TCons ("Network","Example") []) (TCons ("Prelude","[]") [TCons ("Prelude","[]") [TCons ("Prelude","[]") [TCons ("Prelude","Float") []]]])))) (Rule [1,2,3] (Let [(4,Comb FuncCall ("Perceptron","feedForward") [Var 1,Comb FuncCall ("Network","inputs") [Var 3],Var 2]),(5,Comb FuncCall ("Prelude","apply") [Comb FuncCall ("Prelude","reverse") [],Comb FuncCall ("Network","layers") [Var 1]]),(6,Comb FuncCall ("Network","learningRate") [Var 1]),(7,Comb FuncCall ("Learn","backPropagate") [Var 5,Comb FuncCall ("Network","expectation") [Var 3],Var 2,Var 4])] (Comb FuncCall ("Learn","gradientDescent") [Var 6,Var 2,Var 4,Var 7]))),Func ("Learn","learnExampleNetwork") 2 Private (FuncType (FuncType (TCons ("Network","Network") []) (FuncType (TCons ("Prelude","[]") [TCons ("Prelude","[]") [TCons ("Prelude","[]") [TCons ("Prelude","Float") []]]]) (FuncType (TCons ("Network","Example") []) (TCons ("Prelude","[]") [TCons ("Prelude","[]") [TCons ("Prelude","[]") [TCons ("Prelude","Float") []]]])))) (FuncType (TCons ("Network","Network") []) (FuncType (TCons ("Prelude","[]") [TCons ("Prelude","[]") [TCons ("Prelude","[]") [TCons ("Prelude","Float") []]]]) (FuncType (TCons ("Network","Example") []) (TCons ("Prelude","[]") [TCons ("Prelude","[]") [TCons ("Prelude","[]") [TCons ("Prelude","Float") []]]]))))) (Rule [1,2] (Comb FuncCall ("Prelude","apply") [Var 1,Var 2])),Func ("Learn","learnEpic") 2 Public (FuncType (TCons ("Network","Network") []) (FuncType (TCons ("Prelude","[]") [TCons ("Prelude","[]") [TCons ("Prelude","[]") [TCons ("Prelude","Float") []]]]) (TCons ("Prelude","[]") [TCons ("Prelude","[]") [TCons ("Prelude","[]") [TCons ("Prelude","Float") []]]]))) (Rule [1,2] (Let [(3,Comb FuncCall ("Learn","learnExampleNetwork") [Comb (FuncPartCall 3) ("Learn","learnExample") [],Var 1])] (Comb FuncCall ("Prelude","foldl") [Var 3,Var 2,Comb FuncCall ("Network","exs") [Var 1]]))),Func ("Learn","learn") 3 Public (FuncType (TCons ("Prelude","Int") []) (FuncType (TCons ("Network","Network") []) (FuncType (TCons ("Prelude","[]") [TCons ("Prelude","[]") [TCons ("Prelude","[]") [TCons ("Prelude","Float") []]]]) (TCons ("Prelude","[]") [TCons ("Prelude","[]") [TCons ("Prelude","[]") [TCons ("Prelude","Float") []]]])))) (Rule [1,2,3] (Let [(4,Comb FuncCall ("Learn","learnEpic") [Var 2,Var 3])] (Case Rigid (Comb FuncCall ("Prelude","_impl#<=#Prelude.Ord#Prelude.Int#") [Var 1,Lit (Intc 0)]) [Branch (Pattern ("Prelude","True") []) (Var 3),Branch (Pattern ("Prelude","False") []) (Comb FuncCall ("Learn","learn") [Comb FuncCall ("Prelude","_impl#-#Prelude.Num#Prelude.Int#") [Var 1,Lit (Intc 1)],Var 2,Var 4])]))),Func ("Learn","initialWeights") 2 Public (FuncType (TCons ("Network","Network") []) (FuncType (TCons ("Prelude","Int") []) (TCons ("Prelude","[]") [TCons ("Prelude","[]") [TCons ("Prelude","[]") [TCons ("Prelude","Float") []]]]))) (Rule [1,2] (Comb FuncCall ("Learn","initialWeights.initLWs.64") [Var 2,Comb FuncCall ("Network","layers") [Var 1]])),Func ("Learn","initialWeights.initLWs.64") 2 Private (FuncType (TCons ("Prelude","Int") []) (FuncType (TCons ("Prelude","[]") [TCons ("Network","Layer") []]) (TCons ("Prelude","[]") [TCons ("Prelude","[]") [TCons ("Prelude","[]") [TCons ("Prelude","Float") []]]]))) (Rule [1,2] (Case Flex (Var 2) [Branch (Pattern ("Prelude","[]") []) (Comb ConsCall ("Prelude","[]") []),Branch (Pattern ("Prelude",":") [3,4]) (Let [(5,Comb FuncCall ("Algorithms","initWeights") [Comb FuncCall ("Network","algorithm") [Var 3]]),(6,Comb FuncCall ("Network","nodes") [Var 3])] (Comb ConsCall ("Prelude",":") [Comb FuncCall ("Learn","initialWeights.initLWs.64.initNWs.69") [Var 3,Var 5,Comb (FuncPartCall 1) ("Prelude","_inst#Prelude.Num#Prelude.Int#") [],Comb (FuncPartCall 1) ("Prelude","_inst#Prelude.Ord#Prelude.Int#") [],Var 1,Var 6],Comb FuncCall ("Learn","initialWeights.initLWs.64") [Var 6,Var 4]]))])),Func ("Learn","initialWeights.initLWs.64.initNWs.69") 6 Private (ForallType [(0,KStar)] (FuncType (TCons ("Network","Layer") []) (FuncType (FuncType (TCons ("Prelude","Int") []) (FuncType (TCons ("Prelude","Int") []) (TCons ("Prelude","Float") []))) (FuncType (FuncType (TCons ("Prelude","()") []) (TCons ("Prelude","_Dict#Num") [TVar 0])) (FuncType (FuncType (TCons ("Prelude","()") []) (TCons ("Prelude","_Dict#Ord") [TVar 0])) (FuncType (TCons ("Prelude","Int") []) (FuncType (TVar 0) (TCons ("Prelude","[]") [TCons ("Prelude","[]") [TCons ("Prelude","Float") []]])))))))) (Rule [1,2,3,4,5,6] (Case Rigid (Comb FuncCall ("Prelude","apply") [Comb FuncCall ("Prelude","apply") [Comb FuncCall ("Prelude","<=") [Var 4],Var 6],Comb FuncCall ("Prelude","apply") [Comb FuncCall ("Prelude","fromInt") [Var 3],Lit (Intc 0)]]) [Branch (Pattern ("Prelude","True") []) (Comb ConsCall ("Prelude","[]") []),Branch (Pattern ("Prelude","False") []) (Comb FuncCall ("Learn","initialWeights.initLWs.64.initNWs.69.initNWs'.72") [Var 1,Var 3,Var 4,Var 2,Var 5,Var 6])])),Func ("Learn","initialWeights.initLWs.64.initNWs.69.initNWs'.72") 6 Private (ForallType [(0,KStar)] (FuncType (TCons ("Network","Layer") []) (FuncType (FuncType (TCons ("Prelude","()") []) (TCons ("Prelude","_Dict#Num") [TVar 0])) (FuncType (FuncType (TCons ("Prelude","()") []) (TCons ("Prelude","_Dict#Ord") [TVar 0])) (FuncType (FuncType (TCons ("Prelude","Int") []) (FuncType (TCons ("Prelude","Int") []) (TCons ("Prelude","Float") []))) (FuncType (TCons ("Prelude","Int") []) (FuncType (TVar 0) (TCons ("Prelude","[]") [TCons ("Prelude","[]") [TCons ("Prelude","Float") []]])))))))) (Rule [1,2,3,4,5,6] (Comb ConsCall ("Prelude",":") [Comb FuncCall ("Learn","initialWeights.initLWs.64.initNWs.69.initNWs'.72.initWs.74") [Var 1,Var 4,Var 5],Comb FuncCall ("Learn","initialWeights.initLWs.64.initNWs.69") [Var 1,Var 4,Var 2,Var 3,Var 5,Comb FuncCall ("Prelude","apply") [Comb FuncCall ("Prelude","apply") [Comb FuncCall ("Prelude","-") [Var 2],Var 6],Comb FuncCall ("Prelude","apply") [Comb FuncCall ("Prelude","fromInt") [Var 2],Lit (Intc 1)]]]])),Func ("Learn","initialWeights.initLWs.64.initNWs.69.initNWs'.72.initWs.74") 3 Private (FuncType (TCons ("Network","Layer") []) (FuncType (FuncType (TCons ("Prelude","Int") []) (FuncType (TCons ("Prelude","Int") []) (TCons ("Prelude","Float") []))) (FuncType (TCons ("Prelude","Int") []) (TCons ("Prelude","[]") [TCons ("Prelude","Float") []])))) (Rule [1,2,3] (Comb FuncCall ("Prelude","replicate") [Comb FuncCall ("Prelude","_impl#+#Prelude.Num#Prelude.Int#") [Var 3,Lit (Intc 1)],Comb FuncCall ("Prelude","apply") [Comb FuncCall ("Prelude","apply") [Var 2,Var 3],Comb FuncCall ("Network","nodes") [Var 1]]]))] []